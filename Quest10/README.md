# Quest 10. 인증의 이해

## Introduction

- 이번 퀘스트에서는 웹에서의 인증에 관해 알아보겠습니다.

## Topics

- Cookie
- Session
- JWT

## Resources

- [MDN - HTTP 쿠키](https://developer.mozilla.org/ko/docs/Web/HTTP/Cookies)
- [Cookies and Sessions](https://web.stanford.edu/~ouster/cgi-bin/cs142-fall10/lecture.php?topic=cookie)
- [JWT](https://jwt.io/)

## Checklist

- 쿠키란 무엇일까요?

  > HTTP 쿠키(웹 쿠키, 브라우저 쿠키)는 서버가 사용자의 웹 브라우저에 전송하는 작은 데이터 조각. 브라우저는 그 데이터 조각들을 저장해 놓았다가, 동일한 서버에 재 요청 시 저장된 데이터를 함께 전송.

- 쿠키의 구성 요소

      - 이름 : 각각의 쿠키를 구별하는 데 사용되는 이름
      - 값 : 쿠키의 이름과 관련된 값
      - 유효시간 : 쿠키의 유지시간
      - 도메인 : 쿠키를 전송할 도메인
      - 경로 : 쿠키를 전송할 요청 경로

- 쿠키는 쿠키는 어떤 식으로 서버와 클라이언트 사이에 정보를 주고받나요?

      1. 클라이언트가 페이지를 요청
      2. 서버에서 쿠키를 생성
      3. HTTP 헤더에 쿠키를 포함 시켜 응답
      4. 브라우저가 종료되어도 쿠키 만료 기간이 있다면 클라이언트에서 보관하고 있음
      5. 같은 요청을 할 경우 HTTP 헤더에 쿠키를 함께 보냄
      6. 서버에서 쿠키를 읽어 이전 상태 정보를 변경 할 필요가 있을 때 쿠키를 업데이트 하여 변경된 쿠키를 HTTP 헤더에 포함시켜 응답

- 웹 어플리케이션의 세션이란 무엇일까요?

  > 쿠키를 기반하고 있지만, 사용자 정보 파일을 브라우저에 저장하는 쿠키와 달리 세션은 서버 측에서 관리.

- 세션의 ID와 내용은 각각 어디에 저장되고 어떻게 서버와 교환되나요?

      1. 클라이언트가 서버에 접속 시 세션 ID를 발급 받음
      2. 클라이언트는 세션 ID에 대해 쿠키를 사용해서 저장하고 가지고 있음
      3. 클라리언트는 서버에 요청할 때, 이 쿠키의 세션 ID를 같이 서버에 전달해서 요청
      4. 서버는 세션 ID를 전달 받아서 별다른 작업없이 세션 ID로 세션에 있는 클라언트 정보를 가져와서 사용
      5. 클라이언트 정보를 가지고 서버 요청을 처리하여 클라이언트에게 응답

- JWT란 무엇인가요?

  > Json Web Token의 약자로 일반적으로 클라이언트와 서버 사이에서 통신할 때 권한을 위해 사용하는 토큰. 웹 상에서 정보를 Json형태로 주고 받기 위해 표준규약에 따라 생성한 암호화된 토큰으로 복잡하고 읽을 수 없는 string 형태로 저장 되어있음.

- JWT 토큰은 어디에 저장되고 어떻게 서버와 교환되나요?

  <p align="center">
    <img src="https://user-images.githubusercontent.com/124439821/230442870-702dbf9d-30a2-4d74-909d-aac22f8dee98.png">
  </p>

      1. 사용자가 id와 password를 입력하여 로그인 요청
      2. 서버는 회원DB에 들어가 있는 사용자인지 확인
      3. 확인이 되면 서버는 로그인 요청 확인 후, secret key를 통해 토큰을 발급
      4. 이것을 클라이언트에 전달
      5. 서비스 요청과 권한을 확인하기 위해서 헤더에 데이터(JWT) 요청
      6. 데이터를 확인하고 JWT에서 사용자 정보를 확인
      7. 클라이언트 요청에 대한 응답과 요청한 데이터를 전달

- 세션

      - 장점 : 쿠키를 포함한 요청이 외부에 노출되더라도 세션 ID 자체는 유의미한 개인정보를 담고 있지 않음. 그러나 해커가 이를 중간에 탈취하여 클라이언트인척 위장할 수 있다는 한계가 존재. 각 사용자마다 고유한 세션 ID가 발급되기 때문에, 요청이 들어올 때마다 회원정보를 확인할 필요가 없음.
      - 단점 : 서버에서 세션 저장소를 사용하므로 요청이 많아지면 서버에 부하가 심해짐.

- JWT 장점

      - Header와 Payload를 가지고 Signature를 생성하므로 데이터 위변조를 막을 수 있음.
      - 인증 정보에 대한 별도의 저장소가 필요 없음.
      - JWT는 토큰에 대한 기본 정보와 전달할 정보 및 토큰이 검증됬음을 증명하는 서명 등 필요한 모든 정보를 자체적으로 지니고 있음.
      - 클라이언트 인증 정보를 저장하는 세션과 다르게, 서버는 무상태가 됨.
      - 확장성이 우수.
      - 토큰 기반으로 다른 로그인 시스템에 접근 및 권한 공유가 가능.
      - OAuth의 경우 Facebook, Google 등 소셜 계정을 이용하여 다른 웹서비스에서도 로그인을 할 수 있음.
      - 모바일 어플리케이션 환경에서도 잘 동작.

- JWT 단점

      - 쿠키/세션과 다르게 JWT는 토큰의 길이가 길어, 인증 요청이 많아질수록 네트워크 부하가 심해짐
      - Payload 자체는 암호화되지 않기 때문에 유저의 중요한 정보는 담을 수 없음.
      - 토큰을 탈취당하면 대처하기 어려움. 토큰은 한 번 발급되면 유효기간이 만료될 때 까지 계속 사용이 가능하기 때문.
      - 특정 사용자의 접속을 강제로 만료하기 어렵지만, 쿠키/세션 기반 인증은 서버 쪽에서 쉽게 세션을 삭제할 수 있음.

## Quest

- 이번에는 메모장 시스템에 로그인 기능을 넣고자 합니다.
  - 사용자는 딱 세 명만 존재한다고 가정하고, 아이디와 비밀번호, 사용자의 닉네임은 하드코딩해도 무방합니다.
  - 로그인했을 때 해당 사용자가 이전에 작업했던 탭들과 마지막으로 활성화된 탭 등의 상태가 로딩 되어야 합니다.
  - 세션을 이용한 버전과, JWT를 이용한 버전 두 가지를 만들어 보세요!
    - 세션을 이용할 경우 세션은 서버의 메모리나 파일에 저장하면 됩니다.

## Advanced

- Web Authentication API(WebAuthn)은 무엇인가요?
